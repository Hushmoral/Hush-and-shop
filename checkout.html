<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Checkout</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
<header class="header sticky">
  <div class="brand">
    <svg class="logo-svg" viewBox="0 0 100 100">
      <defs>
        <linearGradient id="g1">
          <stop offset="0" stop-color="#ff6fa3"/>
          <stop offset="0.6" stop-color="#ff385c"/>
          <stop offset="1" stop-color="#7b4bff"/>
        </linearGradient>
      </defs>
      <rect rx="16" width="100" height="100" fill="url(#g1)"/>
      <text x="50%" y="58%" text-anchor="middle" fill="#fff" font-size="36">H&amp;S</text>
    </svg>
    <div>
      <h1>Hush & Shop</h1>
      <div style="font-size:12px;opacity:0.9">Shop Smart. Shop Stylish.</div>
    </div>
  </div>

  <form id="globalSearchForm" onsubmit="return doGlobalSearch(event)" class="global-search">
    <input id="globalSearchInput" type="search" placeholder="Search products, categories...">
    <button type="submit" class="btn">Search</button>
  </form>

  <nav class="nav">
    <a href="index.html">Home</a>
    <a href="deals.html">Deals</a>
    <div class="dropdown">
      <button class="dropbtn">Categories</button>
      <div class="dropdown-content">
        <a href="electronics.html">Electronics</a>
        <a href="fashion.html">Fashion & Apparel</a>
        <a href="home.html">Home & Garden</a>
        <a href="health.html">Health & Beauty</a>
        <a href="groceries.html">Groceries</a>
        <a href="books.html">Books & Media</a>
        <a href="sports.html">Sports & Outdoors</a>
        <a href="toys.html">Toys & Hobbies</a>
        <a href="automotive.html">Automotive</a>
        <a href="pets.html">Pets</a>
      </div>
    </div>
    <a href="cart.html">Cart</a>
    <button id="cartToggle" class="cart-btn">ðŸ›’ <span id="cartCount">0</span></button>
  </nav>
</header>

<main class="container">
  <h2>Checkout</h2>
  <div id="orderSummary"></div>

  <!-- âœ… Netlify form setup -->
<form id="checkoutForm" name="order" method="POST" data-netlify="true" action="/thank-you.html">
  <input type="hidden" name="form-name" value="order">
  <input type="hidden" name="orderSummary" id="orderSummaryField">

  <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
    <input name="fullName" placeholder="Full name" required>
    <input name="email" placeholder="Email" required>
    <input name="phone" placeholder="Phone" required>
    <input name="address" placeholder="Address" required>
    <input name="city" placeholder="City" required>
    <input name="state" placeholder="State" required>
    <input name="zip" placeholder="ZIP" required>
    <input name="country" placeholder="Country" required>
  </div>

  <h3>Payment (demo)</h3>
  <input name="cardNumber" placeholder="Card number">
  <div style="display:flex;gap:8px">
    <input name="expiry" placeholder="MM/YY">
    <input name="cvv" placeholder="CVV">
  </div>

  <button type="submit" class="btn primary">Place Order</button>
</form>

</main>

<aside id="cartSidebar" class="cart-sidebar">
  <button id="closeSidebar" style="float:right;background:transparent;border:none;font-size:18px">âœ•</button>
  <h3>Your Cart</h3>
  <div id="cartItemsArea" style="margin-top:12px;max-height:60vh;overflow:auto"></div>
  <div class="cart-footer">
    <div style="font-weight:700">Subtotal: <span id="cartSubtotal">$0.00</span></div>
    <div style="margin-top:10px">
      <a href="cart.html"><button class="btn primary">View Full Cart</button></a>
    </div>
  </div>
</aside>

<script src="products.js"></script>
<script src="script.js"></script>
<script>
const cart = JSON.parse(localStorage.getItem('cart') || '[]');
const orderSummaryEl = document.getElementById('orderSummary');

if (cart.length === 0) {
  orderSummaryEl.innerHTML = '<p>Your cart is empty.</p>';
} else {
  let total = 0;
  orderSummaryEl.innerHTML = '<h3>Order Summary</h3>' +
    cart.map(i => {
      total += i.price * i.quantity;
      return `<div>${i.name} x ${i.quantity} - $${(i.price * i.quantity).toFixed(2)}</div>`;
    }).join('') +
    `<p style="font-weight:700">Total: $${total.toFixed(2)}</p>`;
}

document.getElementById('checkoutForm').addEventListener('submit', function() {
  const c = JSON.parse(localStorage.getItem('cart') || '[]');
  let summary = c.map(i => `${i.name} x ${i.quantity} - $${(i.price * i.quantity).toFixed(2)}`).join('\n');
  let total = c.reduce((s, i) => s + (i.price * i.quantity), 0);
  summary += `\n\nTotal: $${total.toFixed(2)}`;

  document.getElementById('orderSummaryField').value = summary;
  localStorage.setItem('lastOrder', JSON.stringify(c));
  localStorage.removeItem('cart');
});
</script>
</body>
</html>
